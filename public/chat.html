<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Wyvern â€” Chat</title>
  <link rel="icon" href="/wyvernLogo.png" />
  <link rel="stylesheet" href="chat-styles.css" />
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <script src="https://cdn.socket.io/4.8.1/socket.io.min.js" crossorigin="anonymous"></script>
</head>
<body>
  <div class="debug" id="debug">Connecting...</div>
  <div class="notification hidden" id="notification"></div>
  
  <div class="server-sidebar">
    <div class="server-icon">
      <img src="/wyvernLogo.png" alt="Wyvern Logo" />
    </div>
  </div>

  <div class="channel-list">
    <div class="channel-section">
      <h4>
        Text Channels
        <button class="add-channel-btn" id="addTextChannelBtn" style="display: none;">+</button>
      </h4>
      <div id="textChannelsList"></div>
    </div>
    
    <div class="channel-section">
      <h4>
        Voice Channels
        <button class="add-channel-btn" id="addVoiceChannelBtn" style="display: none;">+</button>
      </h4>
      <div id="voiceChannelsList"></div>
    </div>

    <!-- User Panel at bottom -->
    <div class="user-panel">
      <div class="user-panel-info">
        <div class="user-panel-avatar" id="userPanelAvatar">
          <div class="user-panel-status" id="userPanelStatus"></div>
        </div>
        <div class="user-panel-details">
          <div class="user-panel-name" id="userPanelName"></div>
          <div class="user-panel-status-text" id="userPanelStatusText">Online</div>
        </div>
      </div>
      <div class="user-panel-controls">
        <button class="user-panel-btn" id="userPanelMute" title="Mute/Unmute">ğŸ¤</button>
        <button class="user-panel-btn" id="userPanelDeafen" title="Deafen">ğŸ”Š</button>
        <button class="user-panel-btn" id="userPanelSettings" title="Settings">âš™ï¸</button>
      </div>
    </div>
  </div>

  <div class="chat-area">
    <div class="chat-header">
      <h2 id="currentChannel">general</h2>
      <div class="user-info">
        <span id="username"></span>
        <span class="admin-badge" id="adminBadge" style="display: none;">ADMIN</span>
        <button class="toggle-users-btn" id="toggleUsersBtn" title="Toggle User List">ğŸ‘¥</button>
        <button class="logout-btn" id="logoutBtn">Logout</button>
      </div>
    </div>
    <div id="chat-messages" class="chat-messages"></div>
    <div class="typing-indicator" id="typingIndicator"></div>
    <div class="chat-input">
      <div class="chat-input-wrapper">
        <input id="chat-input" placeholder="Message #general" />
        <div class="chat-input-actions">
          <button class="chat-input-action-btn" title="Add emoji">ğŸ˜Š</button>
        </div>
      </div>
      <button id="send-button" title="Send message">â¤</button>
    </div>
  </div>

  <div class="users-panel" id="usersPanel">
    <div class="users-panel-header">
      <h3>Online Users</h3>
      <span class="users-count" id="usersCount">0</span>
    </div>
    <div class="users-list" id="usersList">
      <!-- Users will be populated here -->
    </div>
  </div>

  <div class="voice-ui" id="voiceUI">
    <div class="voice-ui-header">
      <div class="voice-ui-channel-info">
        <h2 id="voiceUITitle">ğŸ”Š Voice Channel</h2>
        <div class="voice-ui-participant-count" id="voiceUIParticipantCount">0 participants</div>
      </div>
      <div class="user-info">
        <span id="voiceUsername"></span>
        <span class="admin-badge" id="voiceAdminBadge" style="display: none;">ADMIN</span>
        <button class="logout-btn" id="voiceLogoutBtn">Logout</button>
      </div>
    </div>
    <div class="voice-ui-content">
      <div class="voice-ui-participants" id="voiceUIParticipants">
        <!-- Participants will be populated here -->
      </div>
      <div class="voice-ui-controls">
        <button class="voice-btn unmute" id="voiceUIMuteBtn" title="Mute/Unmute">ğŸ¤</button>
        <button class="voice-btn disconnect" id="voiceUIDisconnectBtn" title="Disconnect">ğŸ“</button>
      </div>
    </div>
  </div>

  <div class="voice-controls" id="voiceControls">
    <div class="voice-status" id="voiceStatus">Connected to voice</div>
    <button class="voice-btn unmute" id="muteBtn" title="Mute/Unmute">ğŸ¤</button>
    <button class="voice-btn disconnect" id="disconnectBtn" title="Disconnect">ğŸ“</button>
  </div>

  <div class="modal" id="channelModal">
    <div class="modal-content">
      <h3>Create New Channel</h3>
      <select id="channelType">
        <option value="text">Text Channel</option>
        <option value="voice">Voice Channel</option>
      </select>
      <input type="text" id="channelName" placeholder="Channel name" />
      <textarea id="channelDescription" placeholder="Channel description (optional)" rows="3"></textarea>
      <div class="modal-buttons">
        <button class="secondary" id="cancelChannel">Cancel</button>
        <button class="primary" id="createChannel">Create</button>
      </div>
    </div>
  </div>

  <div class="modal" id="deleteModal">
    <div class="modal-content">
      <h3>Delete Channel</h3>
      <p>Are you sure you want to delete <strong id="deleteChannelName"></strong>?</p>
      <p style="color: var(--text-muted); font-size: 12px; margin-top: 8px;">This action cannot be undone.</p>
      <div class="modal-buttons">
        <button class="secondary" id="cancelDelete">Cancel</button>
        <button class="danger" id="confirmDelete">Delete</button>
      </div>
    </div>
  </div>

  <div class="voice-modal" id="voiceModal">
    <div class="voice-modal-content">
      <div class="voice-modal-header">
        <div class="voice-modal-title" id="voiceModalTitle">ğŸ”Š Voice Channel</div>
        <button class="voice-modal-close" id="voiceModalClose">Ã—</button>
      </div>
      <div class="voice-modal-participants" id="voiceModalParticipants">
        <!-- Participants will be populated here -->
      </div>
      <div class="voice-modal-controls">
        <button class="voice-btn unmute" id="modalMuteBtn" title="Mute/Unmute">ğŸ¤</button>
        <button class="voice-btn disconnect" id="modalDisconnectBtn" title="Disconnect">ğŸ“</button>
      </div>
    </div>
  </div>

  <!-- Context Menu -->
  <div class="context-menu" id="contextMenu">
    <div class="context-menu-header" id="contextMenuHeader">User Options</div>
    
    <div class="context-menu-item" id="contextProfile">
      <span>ğŸ‘¤</span>
      <span>View Profile</span>
    </div>
    
    <div class="context-menu-separator"></div>
    
    <div class="context-menu-item" id="contextLocalMute">
      <span>ğŸ”‡</span>
      <span>Mute for Me</span>
    </div>
    
    <div class="context-menu-volume">
      <label>Volume for Me</label>
      <input type="range" id="contextVolumeSlider" min="0" max="200" value="100">
      <div class="volume-display" id="contextVolumeDisplay">100%</div>
    </div>
    
    <div class="context-menu-separator"></div>
    
    <!-- Admin options (hidden by default) -->
    <div class="context-menu-item danger" id="contextServerMute" style="display: none;">
      <span>ğŸ”‡</span>
      <span>Server Mute</span>
    </div>
    
    <div class="context-menu-item danger" id="contextServerDeafen" style="display: none;">
      <span>ğŸ”Š</span>
      <span>Server Deafen</span>
    </div>
    
    <div class="context-menu-item danger" id="contextKickVoice" style="display: none;">
      <span>ğŸ‘¢</span>
      <span>Kick from Voice</span>
    </div>
    
    <div class="context-menu-separator" id="contextAdminSeparator" style="display: none;"></div>
    
    <div class="context-menu-item danger" id="contextBanUser" style="display: none;">
      <span>ğŸ”¨</span>
      <span>Ban User</span>
    </div>
  </div>
  <script src="chat.js"></script>
</body>
</html>