<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Wyvern â€” Chat</title>
  <link rel="icon" href="/wyvernLogo.png" />
  <link rel="stylesheet" href="chat-styles.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <script src="https://cdn.socket.io/4.8.1/socket.io.min.js" crossorigin="anonymous"></script>
</head>
<body>
  <!-- Toast Notification Container -->
  <div class="toast-container" id="toastContainer"></div>
  
  <div class="sidebar-container">
    <div class="sidebar-top">
      <div class="server-sidebar">
        <div class="server-icon">
          <img src="/wyvernLogo.png" alt="Wyvern Logo" />
        </div>
      </div>

      <div class="channel-list">
        <div class="channel-section">
          <h4>
            Text Channels
            <button class="add-channel-btn" id="addTextChannelBtn" style="display: none;">+</button>
          </h4>
          <div id="textChannelsList"></div>
        </div>
        
        <div class="channel-section">
          <h4>
            Voice Channels
            <button class="add-channel-btn" id="addVoiceChannelBtn" style="display: none;">+</button>
          </h4>
          <div id="voiceChannelsList"></div>
        </div>
      </div>
    </div>

    <!-- Voice Connection Bar (shows when in voice) -->
    <div class="voice-connection-bar" id="voiceConnectionBar" style="display: none;">
      <div class="voice-connection-info">
        <div class="voice-connection-status">
          <i class="fas fa-signal"></i>
          <span class="voice-connection-label">Voice Connected</span>
        </div>
        <div class="voice-connection-channel" id="voiceConnectionChannel">
          <i class="fas fa-volume-up"></i>
          <span id="voiceConnectionChannelName">Channel</span>
        </div>
      </div>
      <div class="voice-connection-controls">
        <button class="voice-connection-btn" id="voiceScreenShare" title="Share Screen (Coming Soon)" disabled>
          <i class="fas fa-desktop"></i>
        </button>
        <button class="voice-connection-btn" id="voiceCamera" title="Toggle Camera (Coming Soon)" disabled>
          <i class="fas fa-video"></i>
        </button>
        <button class="voice-connection-btn disconnect-btn" id="voiceDisconnect" title="Disconnect">
          <i class="fas fa-phone-slash"></i>
        </button>
      </div>
    </div>

    <!-- User Panel spanning both sidebars -->
    <div class="user-panel">
      <div class="user-panel-info">
        <div class="user-panel-avatar" id="userPanelAvatar">
          <div class="user-panel-status" id="userPanelStatus"></div>
        </div>
        <div class="user-panel-details">
          <div class="user-panel-name-container">
            <div class="user-panel-name" id="userPanelName"></div>
            <span class="user-panel-admin-badge" id="userPanelAdminBadge" style="display: none;">ADMIN</span>
          </div>
          <div class="user-panel-status-text" id="userPanelStatusText">Online</div>
        </div>
      </div>
      <div class="user-panel-controls">
        <button class="user-panel-btn" id="userPanelMute" title="Mute/Unmute">
          <i class="fas fa-microphone"></i>
        </button>
        <button class="user-panel-btn" id="userPanelDeafen" title="Deafen">
          <i class="fas fa-headphones"></i>
        </button>
        <button class="user-panel-btn" id="userPanelSettings" title="Settings">
          <i class="fas fa-cog"></i>
        </button>
      </div>
    </div>
  </div>

  <div class="chat-area">
    <div class="chat-header">
      <h2 id="currentChannel">general</h2>
      <div class="user-info">
        <button class="toggle-users-btn" id="toggleUsersBtn" title="Toggle User List">
          <i class="fas fa-users"></i>
        </button>
        <button class="logout-btn" id="logoutBtn">
          <i class="fas fa-sign-out-alt"></i>
          <span>Logout</span>
        </button>
      </div>
    </div>
    <div id="chat-messages" class="chat-messages"></div>
    <div class="typing-indicator" id="typingIndicator"></div>
    <div class="chat-input">
      <div class="chat-input-wrapper">
        <input id="chat-input" placeholder="Message #general" />
        <div class="chat-input-actions">
          <button class="chat-input-action-btn" title="Add emoji">
            <i class="far fa-smile"></i>
          </button>
        </div>
      </div>
      <button id="send-button" title="Send message">
        <i class="fas fa-paper-plane"></i>
      </button>
    </div>
  </div>

  <div class="users-panel" id="usersPanel">
    <div class="users-panel-header">
      <h3>Online Users</h3>
      <span class="users-count" id="usersCount">0</span>
    </div>
    <div class="users-list" id="usersList">
      <!-- Users will be populated here -->
    </div>
  </div>

  <div class="voice-ui" id="voiceUI">
    <div class="voice-ui-header">
      <div class="voice-ui-channel-info">
        <h2 id="voiceUITitle">ðŸ”Š Voice Channel</h2>
        <div class="voice-ui-participant-count" id="voiceUIParticipantCount">0 participants</div>
      </div>
      <div class="user-info">
        <span id="voiceUsername"></span>
        <span class="admin-badge" id="voiceAdminBadge" style="display: none;">ADMIN</span>
        <button class="logout-btn" id="voiceLogoutBtn">Logout</button>
      </div>
    </div>
    <div class="voice-ui-content">
      <div class="voice-ui-participants" id="voiceUIParticipants">
        <!-- Participants will be populated here -->
      </div>
      <div class="voice-ui-controls">
        <button class="voice-btn unmute" id="voiceUIMuteBtn" title="Mute/Unmute">ðŸŽ¤</button>
        <button class="voice-btn disconnect" id="voiceUIDisconnectBtn" title="Disconnect">ðŸ“ž</button>
      </div>
    </div>
  </div>

  <div class="modal" id="channelModal">
    <div class="modal-content">
      <h3>Create New Channel</h3>
      <select id="channelType">
        <option value="text">Text Channel</option>
        <option value="voice">Voice Channel</option>
      </select>
      <input type="text" id="channelName" placeholder="Channel name" />
      <textarea id="channelDescription" placeholder="Channel description (optional)" rows="3"></textarea>
      <div class="modal-buttons">
        <button class="secondary" id="cancelChannel">Cancel</button>
        <button class="primary" id="createChannel">Create</button>
      </div>
    </div>
  </div>

  <div class="modal" id="deleteModal">
    <div class="modal-content">
      <h3>Delete Channel</h3>
      <p>Are you sure you want to delete <strong id="deleteChannelName"></strong>?</p>
      <p style="color: var(--text-muted); font-size: 12px; margin-top: 8px;">This action cannot be undone.</p>
      <div class="modal-buttons">
        <button class="secondary" id="cancelDelete">Cancel</button>
        <button class="danger" id="confirmDelete">Delete</button>
      </div>
    </div>
  </div>

  <div class="voice-modal" id="voiceModal">
    <div class="voice-modal-content">
      <div class="voice-modal-header">
        <div class="voice-modal-title" id="voiceModalTitle">ðŸ”Š Voice Channel</div>
        <button class="voice-modal-close" id="voiceModalClose">Ã—</button>
      </div>
      <div class="voice-modal-participants" id="voiceModalParticipants">
        <!-- Participants will be populated here -->
      </div>
      <div class="voice-modal-controls">
        <button class="voice-btn unmute" id="modalMuteBtn" title="Mute/Unmute">ðŸŽ¤</button>
        <button class="voice-btn disconnect" id="modalDisconnectBtn" title="Disconnect">ðŸ“ž</button>
      </div>
    </div>
  </div>

  <!-- Context Menu -->
  <div class="context-menu" id="contextMenu">
    <div class="context-menu-header" id="contextMenuHeader">User Options</div>
    
    <div class="context-menu-item" id="contextProfile">
      <span>ðŸ‘¤</span>
      <span>View Profile</span>
    </div>
    
    <div class="context-menu-separator"></div>
    
    <div class="context-menu-item" id="contextLocalMute">
      <span>ðŸ”‡</span>
      <span>Mute for Me</span>
    </div>
    
    <div class="context-menu-volume">
      <label>Volume for Me</label>
      <input type="range" id="contextVolumeSlider" min="0" max="200" value="100">
      <div class="volume-display" id="contextVolumeDisplay">100%</div>
    </div>
    
    <div class="context-menu-separator"></div>
    
    <!-- Admin options (hidden by default) -->
    <div class="context-menu-item danger" id="contextServerMute" style="display: none;">
      <span>ðŸ”‡</span>
      <span>Server Mute</span>
    </div>
    
    <div class="context-menu-item danger" id="contextServerDeafen" style="display: none;">
      <span>ðŸ”Š</span>
      <span>Server Deafen</span>
    </div>
    
    <div class="context-menu-item danger" id="contextKickVoice" style="display: none;">
      <span>ðŸ‘¢</span>
      <span>Kick from Voice</span>
    </div>
    
    <div class="context-menu-separator" id="contextAdminSeparator" style="display: none;"></div>
    
    <div class="context-menu-item danger" id="contextBanUser" style="display: none;">
      <span>ðŸ”¨</span>
      <span>Ban User</span>
    </div>
  </div>
  <script src="chat.js"></script>
</body>
</html>